{"ast":null,"code":"import _Reflect$construct from \"@babel/runtime-corejs2/core-js/reflect/construct\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = _Reflect$construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false; if (_Reflect$construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(_Reflect$construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport { withRouter } from 'next/router';\nimport { connect } from 'react-redux';\nimport { Input, Button, Spin, Tabs, Tag, DatePicker, Row } from 'antd';\nimport { images } from \"../../../../../../../config/images\";\nimport MyModal from \"../../../../../../Components/MyModal\";\nimport { showNotification } from \"../../../../../../../common/function\";\nimport { Router } from \"../../../../../../../common/routes\";\nimport { isMobile } from 'react-device-detect';\nimport \"./style.scss\";\nimport GapService from \"../../../../../../../controller/Api/Services/Gap\";\nimport TweenOneGroup from 'rc-tween-one';\nimport { PlusOutlined, LoadingOutlined } from '@ant-design/icons';\nimport moment from 'moment';\n\nvar ConfigConsignmentId = /*#__PURE__*/function (_React$Component) {\n  _inherits(ConfigConsignmentId, _React$Component);\n\n  var _super = _createSuper(ConfigConsignmentId);\n\n  function ConfigConsignmentId(props) {\n    var _this;\n\n    _classCallCheck(this, ConfigConsignmentId);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"fetchAllTags\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var tags, tempTags;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              tags = _this.state.tags;\n              tempTags = tags;\n\n              _this.setState({\n                isLoadingTags: true\n              }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                var res;\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.next = 2;\n                        return GapService.getConsignmentID();\n\n                      case 2:\n                        res = _context.sent;\n\n                        if (res && res.results && res.results.length > 0) {\n                          res.results.map(function (tag) {\n                            tempTags.push(\"\".concat(tag.code));\n                          });\n\n                          _this.setState({\n                            allInfoTag: res.results,\n                            tags: tempTags,\n                            isLoadingTags: false\n                          });\n                        } else {\n                          _this.setState({\n                            isLoadingTags: false\n                          });\n                        }\n\n                      case 4:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              })));\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClose\", /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(removedTag) {\n        var tags, allInfoTag, foundTagItem, res;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                tags = _this.state.tags.filter(function (tag) {\n                  return tag !== removedTag;\n                });\n                allInfoTag = _this.state.allInfoTag.filter(function (tag) {\n                  return tag.code !== removedTag;\n                });\n                foundTagItem = _this.state.allInfoTag.filter(function (tag) {\n                  return tag.code === removedTag;\n                });\n\n                if (!(foundTagItem && foundTagItem[0] && foundTagItem[0].objectId)) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                _this.setState({\n                  tags: tags,\n                  allInfoTag: allInfoTag\n                });\n\n                _context3.next = 7;\n                return GapService.deleteConsignmentID(foundTagItem[0].objectId);\n\n              case 7:\n                res = _context3.sent;\n\n                if (res) {\n                  showNotification(\"Xo\\xE1 th\\xE0nh c\\xF4ng \".concat(foundTagItem[0].code));\n                } else {\n                  showNotification('Xoá thất bại');\n                }\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"showInput\", function () {\n      _this.setState({\n        inputVisible: true\n      }, function () {\n        return _this.input.focus();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleInputChange\", function (e) {\n      _this.setState({\n        inputValue: e.target.value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleInputConfirm\", function () {\n      var _this$state = _this.state,\n          inputValue = _this$state.inputValue,\n          timeGetMoney = _this$state.timeGetMoney;\n      var _this$state2 = _this.state,\n          tags = _this$state2.tags,\n          allInfoTag = _this$state2.allInfoTag;\n\n      if (inputValue && tags.indexOf(inputValue) === -1) {\n        var newTag = {\n          code: inputValue,\n          timeGetMoney: timeGetMoney\n        };\n        tags = [].concat(_toConsumableArray(tags), [inputValue]);\n\n        _this.setState({\n          tags: tags,\n          inputVisible: false,\n          inputValue: ''\n        }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n          var res;\n          return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n            while (1) {\n              switch (_context4.prev = _context4.next) {\n                case 0:\n                  _context4.next = 2;\n                  return GapService.setConsignmentID(newTag);\n\n                case 2:\n                  res = _context4.sent;\n\n                  if (res && res.objectId) {\n                    _this.setState({\n                      allInfoTag: [].concat(_toConsumableArray(allInfoTag), [{\n                        code: inputValue,\n                        timeGetMoney: timeGetMoney,\n                        objectId: res.objectId\n                      }])\n                    }, function () {\n                      return showNotification('Thêm thành công');\n                    });\n                  } else {\n                    showNotification('Thêm thất bại');\n                  }\n\n                case 4:\n                case \"end\":\n                  return _context4.stop();\n              }\n            }\n          }, _callee4);\n        })));\n      } else {\n        showNotification('Mã đã tồn tại');\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"saveInputRef\", function (input) {\n      _this.input = input;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"forMap\", function (tag) {\n      var tagElem = __jsx(Tag, {\n        closable: true,\n        onClose: function onClose(e) {\n          e.preventDefault();\n\n          _this.handleClose(tag);\n        }\n      }, tag);\n\n      return __jsx(\"span\", {\n        key: tag,\n        style: {\n          display: 'inline-block'\n        }\n      }, tagElem);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChangeTimeGetMoney\", function (value) {\n      try {\n        var formatTime = moment(value).format('DD-MM-YYYY');\n\n        _this.setState({\n          timeGetMoney: formatTime\n        }, function () {\n          console.log(_this.state);\n        });\n      } catch (e) {\n        console.log(e);\n        showNotification('Lỗi');\n      }\n    });\n\n    _this.state = {\n      tags: [],\n      allInfoTag: [],\n      timeGetMoney: moment(),\n      isLoadingTags: false,\n      inputVisible: false,\n      inputValue: ''\n    };\n    _this.myModal = /*#__PURE__*/React.createRef();\n    return _this;\n  }\n\n  _createClass(ConfigConsignmentId, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchAllTags();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state3 = this.state,\n          tags = _this$state3.tags,\n          inputVisible = _this$state3.inputVisible,\n          inputValue = _this$state3.inputValue,\n          isLoadingTags = _this$state3.isLoadingTags;\n      var tagChild = tags.map(this.forMap);\n      return __jsx(\"div\", {\n        className: \"ConfigConsignmentId-container\"\n      }, __jsx(\"div\", {\n        style: {\n          marginBottom: 16\n        }\n      }, isLoadingTags ? __jsx(LoadingOutlined, null) : __jsx(TweenOneGroup, {\n        enter: {\n          scale: 0.8,\n          opacity: 0,\n          type: 'from',\n          duration: 100,\n          onComplete: function onComplete(e) {\n            e.target.style = '';\n          }\n        },\n        leave: {\n          opacity: 0,\n          width: 0,\n          scale: 0,\n          duration: 200\n        },\n        appear: false\n      }, tagChild)), inputVisible && __jsx(React.Fragment, null, __jsx(Input.Group, {\n        compact: true\n      }, __jsx(Input, {\n        onChange: this.handleInputChange,\n        size: \"small\",\n        ref: this.saveInputRef,\n        style: {\n          width: 150,\n          height: 40,\n          maxWidth: '50%'\n        },\n        placeholder: \"...\"\n      }), __jsx(DatePicker, {\n        onChange: this.onChangeTimeGetMoney,\n        placeholder: \"DD-MM-YYYY\",\n        format: \"DD-MM-YYYY\",\n        defaultValue: moment(),\n        style: {\n          width: 200,\n          height: 40,\n          maxWidth: '50%'\n        }\n      })), __jsx(Button, {\n        onClick: this.handleInputConfirm,\n        className: \"MT10\"\n      }, \"Th\\xEAm\")), !inputVisible && __jsx(Tag, {\n        onClick: this.showInput,\n        className: \"site-tag-plus\"\n      }, __jsx(PlusOutlined, null), \" Th\\xEAm m\\xE3 m\\u1EDBi\"));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(_ref5) {\n        var query;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                query = _ref5.query;\n                return _context5.abrupt(\"return\", {\n                  query: query\n                });\n\n              case 2:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      function getInitialProps(_x2) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return ConfigConsignmentId;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    locale: state.locale,\n    userData: state.userData\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, null)(ConfigConsignmentId)); //   <Input\n//     ref={this.saveInputRef}\n//     type='text'\n//     size='small'\n//     style={{ width: 78 }}\n//     value={inputValue}\n//     onChange={this.handleInputChange}\n//     onBlur={this.handleInputConfirm}\n//     onPressEnter={this.handleInputConfirm}\n//   />","map":{"version":3,"sources":["/Users/macbook/Desktop/giveawaypremium-client/pages/Screen/DashBoard/components/SettingScreen/Components/ConfigConsignmentId/index.js"],"names":["React","withRouter","connect","Input","Button","Spin","Tabs","Tag","DatePicker","Row","images","MyModal","showNotification","Router","isMobile","GapService","TweenOneGroup","PlusOutlined","LoadingOutlined","moment","ConfigConsignmentId","props","tags","state","tempTags","setState","isLoadingTags","getConsignmentID","res","results","length","map","tag","push","code","allInfoTag","removedTag","filter","foundTagItem","objectId","deleteConsignmentID","inputVisible","input","focus","e","inputValue","target","value","timeGetMoney","indexOf","newTag","setConsignmentID","tagElem","preventDefault","handleClose","display","formatTime","format","console","log","myModal","createRef","fetchAllTags","tagChild","forMap","marginBottom","scale","opacity","type","duration","onComplete","style","width","handleInputChange","saveInputRef","height","maxWidth","onChangeTimeGetMoney","handleInputConfirm","showInput","query","Component","mapStateToProps","locale","userData"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { withRouter } from 'next/router'\nimport { connect } from 'react-redux'\nimport { Input, Button, Spin, Tabs, Tag, DatePicker, Row } from 'antd'\nimport { images } from 'config/images'\nimport MyModal from 'pages/Components/MyModal'\nimport { showNotification } from 'common/function'\nimport { Router } from 'common/routes'\nimport { isMobile } from 'react-device-detect'\nimport './style.scss'\nimport GapService from 'controller/Api/Services/Gap'\nimport TweenOneGroup from 'rc-tween-one'\nimport { PlusOutlined, LoadingOutlined } from '@ant-design/icons'\nimport moment from 'moment'\n\nclass ConfigConsignmentId extends React.Component {\n  static async getInitialProps ({ query }) {\n    return { query }\n  }\n  constructor (props) {\n    super(props)\n    this.state = {\n      tags: [],\n      allInfoTag: [],\n      timeGetMoney: moment(),\n      isLoadingTags: false,\n      inputVisible: false,\n      inputValue: ''\n    }\n    this.myModal = React.createRef()\n  }\n\n  componentDidMount () {\n    this.fetchAllTags()\n  }\n\n  fetchAllTags = async () => {\n    const { tags } = this.state\n    const tempTags = tags\n    this.setState({\n      isLoadingTags: true\n    }, async () => {\n      const res = await GapService.getConsignmentID()\n      if (res && res.results && res.results.length > 0) {\n        res.results.map(tag => {\n          tempTags.push(`${tag.code}`)\n        })\n\n        this.setState({\n          allInfoTag: res.results,\n          tags: tempTags,\n          isLoadingTags: false\n        })\n      } else {\n        this.setState({\n          isLoadingTags: false\n        })\n      }\n    })\n  }\n\n  handleClose = async removedTag => {\n    const tags = this.state.tags.filter(tag => tag !== removedTag)\n    const allInfoTag = this.state.allInfoTag.filter(tag => tag.code !== removedTag)\n    const foundTagItem = this.state.allInfoTag.filter(tag => tag.code === removedTag)\n\n    if (foundTagItem && foundTagItem[0] && foundTagItem[0].objectId) {\n      this.setState({ tags, allInfoTag })\n\n      const res = await GapService.deleteConsignmentID(foundTagItem[0].objectId)\n\n      if (res) {\n        showNotification(`Xoá thành công ${foundTagItem[0].code}`)\n      } else {\n        showNotification('Xoá thất bại')\n      }\n    }\n  };\n\n  showInput = () => {\n    this.setState({ inputVisible: true }, () => this.input.focus())\n  };\n\n  handleInputChange = e => {\n    this.setState({ inputValue: e.target.value })\n  };\n\n  handleInputConfirm = () => {\n    const { inputValue, timeGetMoney } = this.state\n    let { tags, allInfoTag } = this.state\n\n    if (inputValue && tags.indexOf(inputValue) === -1) {\n      const newTag = { code: inputValue, timeGetMoney: timeGetMoney }\n\n      tags = [...tags, inputValue]\n      this.setState({\n        tags,\n        inputVisible: false,\n        inputValue: ''\n      }, async () => {\n        const res = await GapService.setConsignmentID(newTag)\n        if (res && res.objectId) {\n          this.setState({\n            allInfoTag: [...allInfoTag, { code: inputValue, timeGetMoney: timeGetMoney, objectId: res.objectId }]\n          }, () => showNotification('Thêm thành công'))\n        } else {\n          showNotification('Thêm thất bại')\n        }\n      })\n    } else {\n      showNotification('Mã đã tồn tại')\n    }\n  };\n\n  saveInputRef = input => {\n    this.input = input\n  };\n\n  forMap = tag => {\n    const tagElem = (\n      <Tag\n        closable\n        onClose={e => {\n          e.preventDefault()\n          this.handleClose(tag)\n        }}\n      >\n        {tag}\n      </Tag>\n    )\n    return (\n      <span key={tag} style={{ display: 'inline-block' }}>\n        {tagElem}\n      </span>\n    )\n  };\n\n  onChangeTimeGetMoney = (value) => {\n    try {\n      const formatTime = moment(value).format('DD-MM-YYYY')\n\n      this.setState({\n        timeGetMoney: formatTime\n      }, () => {\n        console.log(this.state)\n      })\n    } catch (e) {\n      console.log(e)\n      showNotification('Lỗi')\n    }\n  }\n\n  render () {\n    const { tags, inputVisible, inputValue, isLoadingTags } = this.state\n    const tagChild = tags.map(this.forMap)\n    return (\n      <div className='ConfigConsignmentId-container'>\n        <div style={{ marginBottom: 16 }}>\n          {\n            isLoadingTags ? <LoadingOutlined />\n              : <TweenOneGroup\n                enter={{\n                  scale: 0.8,\n                  opacity: 0,\n                  type: 'from',\n                  duration: 100,\n                  onComplete: e => {\n                    e.target.style = ''\n                  }\n                }}\n                leave={{ opacity: 0, width: 0, scale: 0, duration: 200 }}\n                appear={false}\n              >\n                {tagChild}\n              </TweenOneGroup>\n          }\n        </div>\n        {inputVisible && (\n        <>\n          <Input.Group compact>\n            <Input onChange={this.handleInputChange} size='small' ref={this.saveInputRef} style={{ width: 150, height: 40, maxWidth: '50%' }} placeholder='...' />\n            <DatePicker onChange={this.onChangeTimeGetMoney} placeholder='DD-MM-YYYY' format='DD-MM-YYYY' defaultValue={moment()} style={{ width: 200, height: 40, maxWidth: '50%' }} />\n          </Input.Group>\n          <Button onClick={this.handleInputConfirm} className='MT10'>Thêm</Button>\n        </>\n        )}\n        {!inputVisible && (\n          <Tag onClick={this.showInput} className='site-tag-plus'>\n            <PlusOutlined /> Thêm mã mới\n          </Tag>\n        )}\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  locale: state.locale,\n  userData: state.userData\n})\n\nexport default withRouter(connect(mapStateToProps, null)(ConfigConsignmentId))\n//   <Input\n//     ref={this.saveInputRef}\n//     type='text'\n//     size='small'\n//     style={{ width: 78 }}\n//     value={inputValue}\n//     onChange={this.handleInputChange}\n//     onBlur={this.handleInputConfirm}\n//     onPressEnter={this.handleInputConfirm}\n//   />\n"]},"metadata":{},"sourceType":"module"}