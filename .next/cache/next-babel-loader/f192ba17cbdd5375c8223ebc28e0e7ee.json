{"ast":null,"code":"import _Reflect$construct from \"@babel/runtime-corejs2/core-js/reflect/construct\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = _Reflect$construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false; if (_Reflect$construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(_Reflect$construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\n/* eslint-disable react/display-name */\nimport React, { useContext, useState, useEffect, useRef } from 'react';\nimport { withRouter } from 'next/router';\nimport { connect } from 'react-redux';\nimport { Form, Row, Col, Layout, Input, Button, Spin, Descriptions, Tabs, Table, Radio, Popconfirm } from 'antd';\nimport { images } from \"../../../../../../../config/images\";\nimport MyModal from \"../../../../../../Components/MyModal\";\nimport { showNotification, numberWithCommas } from \"../../../../../../../common/function\";\nimport { LoadingOutlined, SearchOutlined } from '@ant-design/icons';\nimport { Router } from \"../../../../../../../common/routes\";\nimport { isMobile } from 'react-device-detect';\nimport \"./style.scss\";\nimport Lottie from 'react-lottie';\nimport GapService from \"../../../../../../../controller/Api/Services/Gap\";\nimport { isEqual } from 'lodash';\nimport Highlighter from 'react-highlight-words';\n\nvar EditableRow = function EditableRow(_ref) {\n  var index = _ref.index,\n      props = _objectWithoutProperties(_ref, [\"index\"]);\n\n  var _Form$useForm = Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  return __jsx(Form, {\n    form: form,\n    component: false\n  }, __jsx(EditableContext.Provider, {\n    value: form\n  }, __jsx(\"tr\", props)));\n};\n\nvar EditableContext = /*#__PURE__*/React.createContext(null);\n\nvar EditableCell = function EditableCell(_ref2) {\n  var title = _ref2.title,\n      editable = _ref2.editable,\n      children = _ref2.children,\n      dataIndex = _ref2.dataIndex,\n      record = _ref2.record,\n      handleSave = _ref2.handleSave,\n      restProps = _objectWithoutProperties(_ref2, [\"title\", \"editable\", \"children\", \"dataIndex\", \"record\", \"handleSave\"]);\n\n  var _useState = useState(false),\n      editing = _useState[0],\n      setEditing = _useState[1];\n\n  var inputRef = useRef(null);\n  var form = useContext(EditableContext);\n  useEffect(function () {\n    if (editing) {\n      inputRef.current.focus();\n    }\n  }, [editing]);\n\n  var toggleEdit = function toggleEdit() {\n    setEditing(!editing);\n    form.setFieldsValue(_defineProperty({}, dataIndex, record[dataIndex]));\n  };\n\n  var save = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var values;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return form.validateFields();\n\n            case 3:\n              values = _context.sent;\n              toggleEdit();\n              handleSave(_objectSpread({}, record, values));\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n              console.log('Save failed:', _context.t0);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 8]]);\n    }));\n\n    return function save() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var childNode = children;\n\n  if (editable) {\n    childNode = editing ? __jsx(Form.Item, {\n      style: {\n        margin: 0\n      },\n      name: dataIndex,\n      rules: [{\n        required: true,\n        message: \"\".concat(title, \" is required.\")\n      }]\n    }, __jsx(Input, {\n      ref: inputRef,\n      onPressEnter: save,\n      onBlur: save\n    })) : __jsx(\"div\", {\n      className: \"editable-cell-value-wrap\",\n      style: {\n        paddingRight: 24\n      },\n      onClick: toggleEdit\n    }, children);\n  }\n\n  return __jsx(\"td\", restProps, childNode);\n};\n\nvar TableConsignemntScreen = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(TableConsignemntScreen, _React$PureComponent);\n\n  var _super = _createSuper(TableConsignemntScreen);\n\n  function TableConsignemntScreen(props) {\n    var _this;\n\n    _classCallCheck(this, TableConsignemntScreen);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"getColumnSearchProps\", function (dataIndex) {\n      return {\n        filterDropdown: function filterDropdown(_ref4) {\n          var setSelectedKeys = _ref4.setSelectedKeys,\n              selectedKeys = _ref4.selectedKeys,\n              confirm = _ref4.confirm,\n              clearFilters = _ref4.clearFilters;\n          return __jsx(\"div\", {\n            style: {\n              padding: 8\n            }\n          }, __jsx(Input, {\n            ref: function ref(node) {\n              _this.searchInput = node;\n            },\n            placeholder: \"T\\xECm s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\",\n            value: selectedKeys[0],\n            onChange: function onChange(e) {\n              return setSelectedKeys(e.target.value ? [e.target.value] : []);\n            },\n            onPressEnter: function onPressEnter() {\n              return _this.handleSearch(selectedKeys, confirm, dataIndex);\n            },\n            style: {\n              width: 188,\n              marginBottom: 8,\n              display: 'block'\n            }\n          }), __jsx(Button, {\n            type: \"primary\",\n            onClick: function onClick() {\n              return _this.handleSearch(selectedKeys, confirm, dataIndex);\n            },\n            icon: __jsx(SearchOutlined, null),\n            size: \"small\",\n            style: {\n              width: '100%'\n            }\n          }, \"T\\xECm ki\\u1EBFm\"));\n        },\n        filterIcon: function filterIcon(filtered) {\n          return __jsx(SearchOutlined, {\n            style: {\n              color: filtered ? '#1890ff' : undefined\n            }\n          });\n        },\n        // onFilter: (value, record) =>\n        //   record[dataIndex]\n        //     ? record[dataIndex].toString().toLowerCase().includes(value.toLowerCase())\n        //     : '',\n        onFilterDropdownVisibleChange: function onFilterDropdownVisibleChange(visible) {\n          if (visible) {\n            setTimeout(function () {\n              return _this.searchInput.select();\n            }, 100);\n          }\n        },\n        render: function render(text) {\n          return _this.state.searchedColumn === dataIndex ? __jsx(Highlighter, {\n            highlightStyle: {\n              backgroundColor: '#ffc069',\n              padding: 0\n            },\n            searchWords: [_this.state.searchText],\n            autoEscape: true,\n            textToHighlight: text ? text.toString() : ''\n          }) : text;\n        }\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChangeRadioIsGetMoney\", /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(row) {\n        var newData, index, item, newItem;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                console.log('onChangeRadioIsGetMoney');\n                console.log(row);\n                newData = _toConsumableArray(_this.state.consignmentData);\n                index = newData.findIndex(function (item) {\n                  return row.objectId === item.objectId;\n                });\n                item = newData[index];\n                newItem = _objectSpread({}, item, row, {\n                  isGetMoney: !item.isGetMoney\n                });\n\n                if (!isEqual(newItem, item)) {\n                  newData.splice(index, 1, newItem);\n                  console.log('row');\n\n                  _this.setState({\n                    consignmentData: newData\n                  }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                    var res;\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            console.log(newItem);\n                            _context2.next = 3;\n                            return GapService.updateConsignment(newItem);\n\n                          case 3:\n                            res = _context2.sent;\n                            console.log(res);\n\n                            if (res) {\n                              showNotification(\"C\\u1EADp nh\\u1EADt th\\xE0nh c\\xF4ng \".concat(item.phoneNumber));\n                            } else {\n                              showNotification(\"C\\u1EADp nh\\u1EADt ch\\u01B0a \\u0111\\u01B0\\u1EE3c\");\n                            }\n\n                          case 6:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2);\n                  })));\n                }\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x) {\n        return _ref5.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSearch\", function (selectedKeys, confirm, dataIndex) {\n      console.log('handleSearch');\n      console.log(selectedKeys); // confirm()\n      // this.fetchTableData(1, selectedKeys[0])\n\n      _this.setState({\n        searchText: selectedKeys[0],\n        searchedColumn: dataIndex\n      }, function () {\n        confirm();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleReset\", function (clearFilters) {\n      clearFilters();\n\n      _this.setState({\n        searchText: ''\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"fetchTableData\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var page,\n          keyword,\n          searchText,\n          _args5 = arguments;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              page = _args5.length > 0 && _args5[0] !== undefined ? _args5[0] : 1;\n              keyword = _args5.length > 1 ? _args5[1] : undefined;\n              searchText = _this.state.searchText;\n\n              _this.setState({\n                isLoadingData: true\n              }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n                var res, consignmentData;\n                return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                  while (1) {\n                    switch (_context4.prev = _context4.next) {\n                      case 0:\n                        if (searchText) {\n                          _context4.next = 6;\n                          break;\n                        }\n\n                        _context4.next = 3;\n                        return GapService.getConsignment(page);\n\n                      case 3:\n                        res = _context4.sent;\n                        _context4.next = 9;\n                        break;\n\n                      case 6:\n                        _context4.next = 8;\n                        return GapService.getConsignment(page, searchText);\n\n                      case 8:\n                        res = _context4.sent;\n\n                      case 9:\n                        console.log('res');\n                        console.log(res);\n                        consignmentData = [];\n\n                        if (res && res.results) {\n                          res.results.map(function (item, indexItem) {\n                            consignmentData.push({\n                              key: indexItem,\n                              objectId: item.objectId,\n                              consignerName: item.consignerName,\n                              consignmentId: item.consignmentId,\n                              consignerIdCard: item.consignerIdCard,\n                              consigneeName: item.consigneeName,\n                              phoneNumber: item.phoneNumber,\n                              numberOfProducts: \"\".concat(Number(item.numberOfProducts)),\n                              numSoldConsignment: \"\".concat(Number(item.numSoldConsignment || 0)),\n                              remainNumConsignment: \"\".concat(Number(item.numberOfProducts) - Number(item.numSoldConsignment || 0)),\n                              bankName: res.results[0].banks[0] ? res.results[0].banks[0].type : '',\n                              bankId: res.results[0].banks[0] ? res.results[0].banks[0].accNumber : '',\n                              moneyBack: item.moneyBack,\n                              email: item.email,\n                              birthday: item.birthday,\n                              isGetMoney: item.isGetMoney\n                            });\n                          });\n\n                          _this.setState({\n                            total: res.count,\n                            consignmentData: consignmentData,\n                            isLoadingData: false\n                          });\n                        } else {\n                          _this.setState({\n                            isLoadingData: false\n                          });\n                        }\n\n                      case 13:\n                      case \"end\":\n                        return _context4.stop();\n                    }\n                  }\n                }, _callee4);\n              })));\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSave\", function (row) {\n      var newData = _toConsumableArray(_this.state.consignmentData);\n\n      var index = newData.findIndex(function (item) {\n        return row.key === item.key;\n      });\n      var item = newData[index];\n      var newRemainNumConsignment = \"\".concat(Number(row.numberOfProducts) - Number(row.numSoldConsignment || 0));\n\n      var newItem = _objectSpread({}, item, row, {\n        remainNumConsignment: newRemainNumConsignment\n      });\n\n      if (!isEqual(newItem, item)) {\n        newData.splice(index, 1, newItem);\n        console.log('row');\n\n        _this.setState({\n          consignmentData: newData\n        }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n          var res;\n          return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n            while (1) {\n              switch (_context6.prev = _context6.next) {\n                case 0:\n                  console.log(newItem);\n                  _context6.next = 3;\n                  return GapService.updateConsignment(newItem);\n\n                case 3:\n                  res = _context6.sent;\n                  console.log(res);\n\n                  if (res) {\n                    showNotification(\"C\\u1EADp nh\\u1EADt th\\xE0nh c\\xF4ng \".concat(item.phoneNumber));\n                  } else {\n                    showNotification(\"C\\u1EADp nh\\u1EADt ch\\u01B0a \\u0111\\u01B0\\u1EE3c\");\n                  }\n\n                case 6:\n                case \"end\":\n                  return _context6.stop();\n              }\n            }\n          }, _callee6);\n        })));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"paginationChange\", function (page) {\n      console.log(page);\n\n      _this.fetchTableData(page);\n    });\n\n    _this.columns = [{\n      title: 'Tên khách hàng',\n      width: 15,\n      dataIndex: 'consignerName',\n      key: 'name'\n    }, _objectSpread({\n      title: 'Số điện thoại',\n      dataIndex: 'phoneNumber',\n      key: '1',\n      width: 10\n    }, _this.getColumnSearchProps('phoneNumber')), {\n      title: 'Mã ký gửi',\n      dataIndex: 'consignmentId',\n      key: '2',\n      width: 10,\n      editable: true\n    }, {\n      title: 'SL ký gửi',\n      dataIndex: 'numberOfProducts',\n      key: '3',\n      width: 5,\n      editable: true\n    }, {\n      title: 'Đã bán',\n      dataIndex: 'numSoldConsignment',\n      key: '4',\n      width: 5,\n      editable: true\n    }, {\n      title: 'Còn lại',\n      dataIndex: 'remainNumConsignment',\n      key: '5',\n      width: 5\n    }, {\n      title: 'Số tiền trả khách',\n      dataIndex: 'moneyBack',\n      key: '6',\n      width: 10,\n      editable: true,\n      render: function render(value) {\n        return __jsx(\"span\", null, value ? numberWithCommas(value) : '0', \" \\u0111\");\n      }\n    }, {\n      title: 'Tên ngân hàng',\n      dataIndex: 'bankName',\n      key: '7',\n      width: 10\n    }, {\n      title: 'ID ngân hàng',\n      dataIndex: 'bankId',\n      key: '8',\n      width: 10\n    }, // {\n    //   title: 'Thời gian trả tiền',\n    //   dataIndex: 'timeGetMoney',\n    //   key: '7',\n    //   width: 10,\n    //   editable: true\n    // },\n    {\n      title: 'Nhận tiền',\n      key: '9',\n      fixed: 'right',\n      width: 5,\n      render: function render(value) {\n        return _this.state.consignmentData.length >= 1 ? __jsx(Popconfirm, {\n          title: \"X\\xE1c nh\\u1EADn\",\n          onConfirm: function onConfirm() {\n            return _this.onChangeRadioIsGetMoney(value);\n          }\n        }, __jsx(Radio.Button, {\n          className: value.isGetMoney ? 'radio-true-isGetMoney' : 'radio-false-isGetMoney',\n          value: value.isGetMoney\n        }, value.isGetMoney ? 'Rồi' : 'Chưa')) : null;\n      }\n    }];\n    _this.state = {\n      consignmentData: [],\n      total: 0,\n      page: 1,\n      searchText: '',\n      searchedColumn: ''\n    };\n    _this.myModal = /*#__PURE__*/React.createRef();\n    return _this;\n  }\n\n  _createClass(TableConsignemntScreen, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchTableData();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {}\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var userData = this.props.userData;\n      var _this$state = this.state,\n          isLoadingData = _this$state.isLoadingData,\n          consignmentData = _this$state.consignmentData,\n          total = _this$state.total;\n      var components = {\n        body: {\n          row: EditableRow,\n          cell: EditableCell\n        }\n      };\n      var columns = this.columns.map(function (col) {\n        if (!col.editable) {\n          return col;\n        }\n\n        return _objectSpread({}, col, {\n          onCell: function onCell(record) {\n            return {\n              record: record,\n              editable: col.editable,\n              dataIndex: col.dataIndex,\n              title: col.title,\n              handleSave: _this2.handleSave\n            };\n          }\n        });\n      });\n      return __jsx(\"div\", {\n        className: \"tableConsignemntScreen-container\"\n      }, __jsx(Table, {\n        components: components,\n        size: \"small\",\n        loading: isLoadingData,\n        columns: columns,\n        dataSource: consignmentData,\n        bordered: true,\n        pagination: {\n          total: total,\n          pageSize: 20,\n          onChange: this.paginationChange\n        },\n        scroll: {\n          x: 1500,\n          y: '65vh'\n        }\n      }), __jsx(MyModal, {\n        ref: this.myModal\n      }));\n    }\n  }]);\n\n  return TableConsignemntScreen;\n}(React.PureComponent);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    locale: state.locale,\n    userData: state.userData\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, null)(TableConsignemntScreen));","map":{"version":3,"sources":["/Users/macbook/Desktop/giveawaypremium-client/pages/Screen/DashBoard/components/ManageScreen/comppnents/TableConsignemntScreen/index.js"],"names":["React","useContext","useState","useEffect","useRef","withRouter","connect","Form","Row","Col","Layout","Input","Button","Spin","Descriptions","Tabs","Table","Radio","Popconfirm","images","MyModal","showNotification","numberWithCommas","LoadingOutlined","SearchOutlined","Router","isMobile","Lottie","GapService","isEqual","Highlighter","EditableRow","index","props","useForm","form","EditableContext","createContext","EditableCell","title","editable","children","dataIndex","record","handleSave","restProps","editing","setEditing","inputRef","current","focus","toggleEdit","setFieldsValue","save","validateFields","values","console","log","childNode","margin","required","message","paddingRight","TableConsignemntScreen","filterDropdown","setSelectedKeys","selectedKeys","confirm","clearFilters","padding","node","searchInput","e","target","value","handleSearch","width","marginBottom","display","filterIcon","filtered","color","undefined","onFilterDropdownVisibleChange","visible","setTimeout","select","render","text","state","searchedColumn","backgroundColor","searchText","toString","row","newData","consignmentData","findIndex","item","objectId","newItem","isGetMoney","splice","setState","updateConsignment","res","phoneNumber","page","keyword","isLoadingData","getConsignment","results","map","indexItem","push","key","consignerName","consignmentId","consignerIdCard","consigneeName","numberOfProducts","Number","numSoldConsignment","remainNumConsignment","bankName","banks","type","bankId","accNumber","moneyBack","email","birthday","total","count","newRemainNumConsignment","fetchTableData","columns","getColumnSearchProps","fixed","length","onChangeRadioIsGetMoney","myModal","createRef","userData","components","body","cell","col","onCell","pageSize","onChange","paginationChange","x","y","PureComponent","mapStateToProps","locale"],"mappings":"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","sourcesContent":["/* eslint-disable react/display-name */\nimport React, { useContext, useState, useEffect, useRef } from 'react'\nimport { withRouter } from 'next/router'\nimport { connect } from 'react-redux'\nimport { Form, Row, Col, Layout, Input, Button, Spin, Descriptions, Tabs, Table, Radio, Popconfirm } from 'antd'\nimport { images } from 'config/images'\nimport MyModal from 'pages/Components/MyModal'\nimport { showNotification, numberWithCommas } from 'common/function'\nimport { LoadingOutlined, SearchOutlined } from '@ant-design/icons'\nimport { Router } from 'common/routes'\nimport { isMobile } from 'react-device-detect'\nimport './style.scss'\nimport Lottie from 'react-lottie'\nimport GapService from 'controller/Api/Services/Gap'\nimport { isEqual } from 'lodash'\nimport Highlighter from 'react-highlight-words'\n\nconst EditableRow = ({ index, ...props }) => {\n  const [form] = Form.useForm()\n  return (\n    <Form form={form} component={false}>\n      <EditableContext.Provider value={form}>\n        <tr {...props} />\n      </EditableContext.Provider>\n    </Form>\n  )\n}\n\nconst EditableContext = React.createContext(null)\n\nconst EditableCell = ({\n  title,\n  editable,\n  children,\n  dataIndex,\n  record,\n  handleSave,\n  ...restProps\n}) => {\n  const [editing, setEditing] = useState(false)\n  const inputRef = useRef(null)\n  const form = useContext(EditableContext)\n  useEffect(() => {\n    if (editing) {\n      inputRef.current.focus()\n    }\n  }, [editing])\n\n  const toggleEdit = () => {\n    setEditing(!editing)\n    form.setFieldsValue({\n      [dataIndex]: record[dataIndex]\n    })\n  }\n\n  const save = async () => {\n    try {\n      const values = await form.validateFields()\n      toggleEdit()\n      handleSave({ ...record, ...values })\n    } catch (errInfo) {\n      console.log('Save failed:', errInfo)\n    }\n  }\n\n  let childNode = children\n\n  if (editable) {\n    childNode = editing ? (\n      <Form.Item\n        style={{\n          margin: 0\n        }}\n        name={dataIndex}\n        rules={[\n          {\n            required: true,\n            message: `${title} is required.`\n          }\n        ]}\n      >\n        <Input ref={inputRef} onPressEnter={save} onBlur={save} />\n      </Form.Item>\n    ) : (\n      <div\n        className='editable-cell-value-wrap'\n        style={{\n          paddingRight: 24\n        }}\n        onClick={toggleEdit}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  return <td {...restProps}>{childNode}</td>\n}\n\nclass TableConsignemntScreen extends React.PureComponent {\n  constructor (props) {\n    super(props)\n    this.columns = [\n      {\n        title: 'Tên khách hàng',\n        width: 15,\n        dataIndex: 'consignerName',\n        key: 'name'\n      },\n      {\n        title: 'Số điện thoại',\n        dataIndex: 'phoneNumber',\n        key: '1',\n        width: 10,\n        ...this.getColumnSearchProps('phoneNumber')\n      },\n      {\n        title: 'Mã ký gửi',\n        dataIndex: 'consignmentId',\n        key: '2',\n        width: 10,\n        editable: true\n      },\n      {\n        title: 'SL ký gửi',\n        dataIndex: 'numberOfProducts',\n        key: '3',\n        width: 5,\n        editable: true\n      },\n      {\n        title: 'Đã bán',\n        dataIndex: 'numSoldConsignment',\n        key: '4',\n        width: 5,\n        editable: true\n      },\n      {\n        title: 'Còn lại',\n        dataIndex: 'remainNumConsignment',\n        key: '5',\n        width: 5\n      },\n      {\n        title: 'Số tiền trả khách',\n        dataIndex: 'moneyBack',\n        key: '6',\n        width: 10,\n        editable: true,\n        render: (value) => <span>{value ? numberWithCommas(value) : '0'} đ</span>\n      },\n      {\n        title: 'Tên ngân hàng',\n        dataIndex: 'bankName',\n        key: '7',\n        width: 10\n      },\n      {\n        title: 'ID ngân hàng',\n        dataIndex: 'bankId',\n        key: '8',\n        width: 10\n      },\n      // {\n      //   title: 'Thời gian trả tiền',\n      //   dataIndex: 'timeGetMoney',\n      //   key: '7',\n      //   width: 10,\n      //   editable: true\n      // },\n      {\n        title: 'Nhận tiền',\n        key: '9',\n        fixed: 'right',\n        width: 5,\n        render: (value) =>\n          this.state.consignmentData.length >= 1 ? (\n            <Popconfirm title='Xác nhận' onConfirm={() => this.onChangeRadioIsGetMoney(value)}>\n              <Radio.Button className={value.isGetMoney ? 'radio-true-isGetMoney' : 'radio-false-isGetMoney'} value={value.isGetMoney}>{value.isGetMoney ? 'Rồi' : 'Chưa'}</Radio.Button>\n            </Popconfirm>\n          ) : null\n      }\n    ]\n    this.state = {\n      consignmentData: [],\n      total: 0,\n      page: 1,\n      searchText: '',\n      searchedColumn: ''\n    }\n    this.myModal = React.createRef()\n  }\n\n  componentDidMount () {\n    this.fetchTableData()\n  }\n\n  componentDidUpdate () {\n\n  }\n\n  getColumnSearchProps = dataIndex => ({\n    filterDropdown: ({ setSelectedKeys, selectedKeys, confirm, clearFilters }) => (\n      <div style={{ padding: 8 }}>\n        <Input\n          ref={node => {\n            this.searchInput = node\n          }}\n          placeholder={`Tìm số điện thoại`}\n          value={selectedKeys[0]}\n          onChange={e => setSelectedKeys(e.target.value ? [e.target.value] : [])}\n          onPressEnter={() => this.handleSearch(selectedKeys, confirm, dataIndex)}\n          style={{ width: 188, marginBottom: 8, display: 'block' }}\n        />\n        {/* <Space> */}\n        <Button\n          type='primary'\n          onClick={() => this.handleSearch(selectedKeys, confirm, dataIndex)}\n          icon={<SearchOutlined />}\n          size='small'\n          style={{ width: '100%' }}\n        >\n            Tìm kiếm\n        </Button>\n        {/* <Button\n          type='link'\n          size='small'\n          onClick={() => {\n            confirm({ closeDropdown: false })\n            this.setState({\n              searchText: selectedKeys[0],\n              searchedColumn: dataIndex\n            })\n          }}\n        >\n            Filter\n        </Button> */}\n        {/* </Space> */}\n      </div>\n    ),\n    filterIcon: filtered => <SearchOutlined style={{ color: filtered ? '#1890ff' : undefined }} />,\n    // onFilter: (value, record) =>\n    //   record[dataIndex]\n    //     ? record[dataIndex].toString().toLowerCase().includes(value.toLowerCase())\n    //     : '',\n    onFilterDropdownVisibleChange: visible => {\n      if (visible) {\n        setTimeout(() => this.searchInput.select(), 100)\n      }\n    },\n    render: text =>\n      this.state.searchedColumn === dataIndex ? (\n        <Highlighter\n          highlightStyle={{ backgroundColor: '#ffc069', padding: 0 }}\n          searchWords={[this.state.searchText]}\n          autoEscape\n          textToHighlight={text ? text.toString() : ''}\n        />\n      ) : (\n        text\n      )\n  });\n\n  onChangeRadioIsGetMoney = async (row) => {\n    console.log('onChangeRadioIsGetMoney')\n    console.log(row)\n\n    const newData = [...this.state.consignmentData]\n    const index = newData.findIndex((item) => row.objectId === item.objectId)\n    const item = newData[index]\n    const newItem = { ...item, ...row, isGetMoney: !item.isGetMoney }\n\n    if (!isEqual(newItem, item)) {\n      newData.splice(index, 1, newItem)\n      console.log('row')\n      this.setState({\n        consignmentData: newData\n      }, async () => {\n        console.log(newItem)\n        const res = await GapService.updateConsignment(newItem)\n        console.log(res)\n        if (res) {\n          showNotification(`Cập nhật thành công ${item.phoneNumber}`)\n        } else {\n          showNotification(`Cập nhật chưa được`)\n        }\n      })\n    }\n  }\n\n  handleSearch = (selectedKeys, confirm, dataIndex) => {\n    console.log('handleSearch')\n    console.log(selectedKeys)\n\n    // confirm()\n    // this.fetchTableData(1, selectedKeys[0])\n    this.setState({\n      searchText: selectedKeys[0],\n      searchedColumn: dataIndex\n    }, () => {\n      confirm()\n    })\n  };\n\n  handleReset = clearFilters => {\n    clearFilters()\n    this.setState({ searchText: '' })\n  };\n\n  fetchTableData = async (page = 1, keyword) => {\n    const { searchText } = this.state\n    this.setState({\n      isLoadingData: true\n    }, async () => {\n      let res\n\n      if (!searchText) {\n        res = await GapService.getConsignment(page)\n      } else {\n        res = await GapService.getConsignment(page, searchText)\n      }\n\n      console.log('res')\n      console.log(res)\n      let consignmentData = []\n      if (res && res.results) {\n        res.results.map((item, indexItem) => {\n          consignmentData.push({\n            key: indexItem,\n            objectId: item.objectId,\n            consignerName: item.consignerName,\n            consignmentId: item.consignmentId,\n            consignerIdCard: item.consignerIdCard,\n            consigneeName: item.consigneeName,\n            phoneNumber: item.phoneNumber,\n            numberOfProducts: `${Number(item.numberOfProducts)}`,\n            numSoldConsignment: `${Number(item.numSoldConsignment || 0)}`,\n            remainNumConsignment: `${Number(item.numberOfProducts) - Number(item.numSoldConsignment || 0)}`,\n            bankName: res.results[0].banks[0] ? res.results[0].banks[0].type : '',\n            bankId: res.results[0].banks[0] ? res.results[0].banks[0].accNumber : '',\n            moneyBack: item.moneyBack,\n            email: item.email,\n            birthday: item.birthday,\n            isGetMoney: item.isGetMoney\n          })\n        })\n        this.setState({\n          total: res.count,\n          consignmentData: consignmentData,\n          isLoadingData: false\n        })\n      } else {\n        this.setState({\n          isLoadingData: false\n        })\n      }\n    })\n  }\n\n  handleSave = (row) => {\n    const newData = [...this.state.consignmentData]\n    const index = newData.findIndex((item) => row.key === item.key)\n    const item = newData[index]\n    const newRemainNumConsignment = `${Number(row.numberOfProducts) - Number(row.numSoldConsignment || 0)}`\n    const newItem = { ...item, ...row, remainNumConsignment: newRemainNumConsignment }\n\n    if (!isEqual(newItem, item)) {\n      newData.splice(index, 1, newItem)\n      console.log('row')\n      this.setState({\n        consignmentData: newData\n      }, async () => {\n        console.log(newItem)\n        const res = await GapService.updateConsignment(newItem)\n        console.log(res)\n        if (res) {\n          showNotification(`Cập nhật thành công ${item.phoneNumber}`)\n        } else {\n          showNotification(`Cập nhật chưa được`)\n        }\n      })\n    }\n  };\n\n  paginationChange = (page) => {\n    console.log(page)\n    this.fetchTableData(page)\n  }\n\n  render () {\n    const { userData } = this.props\n    const { isLoadingData, consignmentData, total } = this.state\n\n    const components = {\n      body: {\n        row: EditableRow,\n        cell: EditableCell\n      }\n    }\n\n    const columns = this.columns.map((col) => {\n      if (!col.editable) {\n        return col\n      }\n\n      return {\n        ...col,\n        onCell: (record) => ({\n          record,\n          editable: col.editable,\n          dataIndex: col.dataIndex,\n          title: col.title,\n          handleSave: this.handleSave\n        })\n      }\n    })\n\n    return (\n      <div className='tableConsignemntScreen-container'>\n        <Table\n          components={components}\n          size='small'\n          loading={isLoadingData}\n          columns={columns}\n          dataSource={consignmentData}\n          bordered\n          pagination={{\n            total: total,\n            pageSize: 20,\n            onChange: this.paginationChange\n          }}\n          scroll={{ x: 1500, y: '65vh' }}\n        />\n        <MyModal ref={this.myModal} />\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  locale: state.locale,\n  userData: state.userData\n})\n\nexport default withRouter(connect(mapStateToProps, null)(TableConsignemntScreen))\n"]},"metadata":{},"sourceType":"module"}